<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>GIS Dashboard</title>

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
</head>
<body>
    <h1>🌍 GIS Dashboard with Flask & Leaflet 🚀</h1>

    <!-- Map -->
    <div id="map"></div>

    <script>
        // Initialize map
        var map = L.map('map').setView([20.5937, 78.9629], 5);

        // Base Layers
        var street = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: '© OpenStreetMap'
        }).addTo(map);

        var satellite = L.tileLayer('https://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}', {
            subdomains:['mt0','mt1','mt2','mt3'],
            attribution: '© Google Satellite'
        });

        var dark = L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
            attribution: '© Carto'
        });

        // Add Layer control
        var baseMaps = {
            "Street": street,
            "Satellite": satellite,
            "Dark": dark
        };
        L.control.layers(baseMaps).addTo(map);

        // Load GeoJSON
        fetch("{{ url_for('static', filename='cities.geojson') }}")
        .then(res => res.json())
        .then(data => {
            L.geoJSON(data, {
                onEachFeature: function (feature, layer) {
                    if (feature.properties) {
                        layer.bindPopup(
                            `<b>${feature.properties.name}</b><br>
                             Capital: ${feature.properties.capital}<br>
                             Population: ${feature.properties.population}`
                        );
                    }
                }
            }).addTo(map);
        });
    </script>
</body>
</html>
